import "std/testing" as t
import "vox/typecheck" as tc

fn test_typecheck_char_literal_smoke() -> () {
  let mut w: tc.World = tc.world();
  let src: String = "fn main() -> u32 {\n  let a: char = 'A';\n  let b: char = '\\n';\n  return a + b;\n}";
  w = add_mod(w, "main", src);
  let r: tc.TcResult = tc.typecheck_world(w);
  t.assert(ok(r));
}

fn test_typecheck_char_literal_unicode_smoke() -> () {
  let mut w: tc.World = tc.world();
  let src: String = "fn main() -> u32 { let c: char = 'ä½ '; return c; }";
  w = add_mod(w, "main", src);
  let r: tc.TcResult = tc.typecheck_world(w);
  t.assert(ok(r));
}

fn test_typecheck_char_literal_match_pattern_smoke() -> () {
  let mut w: tc.World = tc.world();
  let src: String = """
    fn classify(c: char) -> i32 {
      return match c {
        'a' => 1,
        _ => 0,
      };
    }
    fn main() -> i32 { return classify('a'); }
  """;
  w = add_mod(w, "main", src);
  let r: tc.TcResult = tc.typecheck_world(w);
  t.assert(ok(r));
}
