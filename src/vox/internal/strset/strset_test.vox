import "std/testing" as t
import "vox/internal/strset" as ss

fn test_internal_strset_sort_smoke() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("b");
  xs.push("a");
  xs.push("c");
  let ys: Vec[String] = ss.sort(xs);
  t.assert_eq(ys.len(), 3);
  t.assert_eq(ys.get(0), "a");
  t.assert_eq(ys.get(1), "b");
  t.assert_eq(ys.get(2), "c");
}

fn test_internal_strset_push_unique_sorted_smoke() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("b");
  xs.push("a");
  let ys: Vec[String] = ss.push_unique_sorted(xs, "b");
  t.assert_eq(ys.len(), 2);
  t.assert_eq(ys.get(0), "a");
  t.assert_eq(ys.get(1), "b");
  let zs: Vec[String] = ss.push_unique_sorted(ys, "c");
  t.assert_eq(zs.len(), 3);
  t.assert_eq(zs.get(0), "a");
  t.assert_eq(zs.get(1), "b");
  t.assert_eq(zs.get(2), "c");
}

fn test_internal_strset_insert_sorted_places_equal_after_existing() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("a");
  xs.push("b");
  xs.push("b");
  xs.push("d");
  let ys: Vec[String] = ss.insert_sorted(xs, "b");
  t.assert_eq(ys.len(), 5);
  t.assert_eq(ys.get(0), "a");
  t.assert_eq(ys.get(1), "b");
  t.assert_eq(ys.get(2), "b");
  t.assert_eq(ys.get(3), "b");
  t.assert_eq(ys.get(4), "d");
}

fn test_internal_strset_push_unique_sorted_keeps_existing_duplicates() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("b");
  xs.push("a");
  xs.push("b");
  let ys: Vec[String] = ss.push_unique_sorted(xs, "b");
  t.assert_eq(ys.len(), 3);
  t.assert_eq(ys.get(0), "a");
  t.assert_eq(ys.get(1), "b");
  t.assert_eq(ys.get(2), "b");
}
