import "std/string" as s
import "std/testing" as t
import "vox/internal/source" as srcw

fn test_walk_vox_files_smoke() -> () {
  let xs: Vec[String] = srcw.walk_vox_files(".");
  t.assert_with(xs.len() > 0, "expected non-empty source set");
  let mut found: bool = false;
  let mut found_syntax_adt: bool = false;
  let mut found_bad_short: bool = false;
  let mut i: i32 = 0;
  while i < xs.len() {
    let p: String = xs.get(i);
    if s.ends_with(s.view_all(p), "src/main.vox") {
      found = true;
    }
    if s.ends_with(s.view_all(p), "tests/syntax/src/adt_test.vox") { found_syntax_adt = true; }
    if s.ends_with(s.view_all(p), "src/adt_test.vox") { found_bad_short = true; }
    i = i + 1;
  }
  t.assert_with(found, "expected src/main.vox in source set");
  t.assert_with(found_syntax_adt, "expected tests/syntax/src/adt_test.vox in source set");
  t.assert_with(!found_bad_short, "unexpected shortened tests path src/adt_test.vox");
}
