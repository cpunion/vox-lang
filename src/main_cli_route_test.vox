import "std/testing" as t

fn test_run_alias_rewrite_fmt_smoke() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("run");
  xs.push("fmt");
  let ys: Vec[String] = rewrite_run_alias(xs);
  t.assert_eq(ys.len(), 1);
  t.assert_eq(ys.get(0), "fmt");
}

fn test_run_alias_rewrite_fmt_with_args_smoke() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("run");
  xs.push("fmt");
  xs.push("--check");
  xs.push("src");
  let ys: Vec[String] = rewrite_run_alias(xs);
  t.assert_eq(ys.len(), 3);
  t.assert_eq(ys.get(0), "fmt");
  t.assert_eq(ys.get(1), "--check");
  t.assert_eq(ys.get(2), "src");
}

fn test_run_alias_rewrite_non_fmt_kept_smoke() -> () {
  let mut xs: Vec[String] = Vec();
  xs.push("run");
  xs.push("target/debug/app");
  let ys: Vec[String] = rewrite_run_alias(xs);
  t.assert_eq(ys.len(), 2);
  t.assert_eq(ys.get(0), "run");
  t.assert_eq(ys.get(1), "target/debug/app");
}

fn test_local_dev_selfhost_cmd_scope_smoke() -> () {
  t.assert(local_dev_selfhost_cmd("fmt"));
  t.assert(local_dev_selfhost_cmd("install"));
  t.assert(!local_dev_selfhost_cmd("build"));
  t.assert(!local_dev_selfhost_cmd("run"));
}

fn test_is_local_selfhost_bin_smoke() -> () {
  t.assert(is_local_selfhost_bin("/a/b/target/debug/vox_rolling"));
  t.assert(is_local_selfhost_bin("/a/b/target/debug/vox_rolling.exe"));
  t.assert(is_local_selfhost_bin("target/debug/vox_rolling"));
  t.assert(!is_local_selfhost_bin("/a/b/target/debug/vox"));
}

fn test_last_non_empty_line_smoke() -> () {
  let s: String = "\n a\n\n b \n";
  t.assert_eq(last_non_empty_line(s), "b");
}
