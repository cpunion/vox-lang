import "std/testing" as t
import "std/time" as tm

fn test_std_time_now_ns_smoke() -> () {
  let n: i64 = tm.now_ns();
  t.assert(n >= 0);
}

fn test_std_time_yield_now_smoke() -> () {
  tm.yield_now();
}

fn test_std_time_duration_64bit_smoke() -> () {
  let d0: tm.Duration = tm.duration_ns(123 as i64);
  t.assert_eq(d0.ns(), 123 as i64);
  t.assert_eq(d0.as_ns(), 123 as i64);
  t.assert_eq(d0.us(), 0 as i64);
  t.assert_eq(d0.as_us(), 0 as i64);

  let d1: tm.Duration = tm.duration_us(7 as i64);
  t.assert_eq(d1.as_ns(), 7000 as i64);

  let d2: tm.Duration = tm.duration_ms(3 as i64);
  t.assert_eq(d2.as_ns(), 3000000 as i64);
  t.assert_eq(d2.ms(), 3 as i64);
  t.assert_eq(d2.as_ms(), 3 as i64);

  let d3: tm.Duration = tm.duration_s(2 as i64);
  t.assert_eq(d3.s(), 2 as i64);
  t.assert_eq(d3.as_ms(), 2000 as i64);
  t.assert_eq(d3.as_s(), 2 as i64);
}

fn test_std_time_unit_constants_smoke() -> () {
  t.assert_eq(tm.nanoseconds, tm.nanosecond);
  t.assert_eq(tm.microseconds, tm.microsecond);
  t.assert_eq(tm.milliseconds, tm.millisecond);
  t.assert_eq(tm.seconds, tm.second);
  t.assert_eq(tm.ns, tm.nanosecond);
  t.assert_eq(tm.us, tm.microsecond);
  t.assert_eq(tm.ms, tm.millisecond);
  t.assert_eq(tm.s, tm.second);
  t.assert_eq((3 as i64) * tm.seconds, 3000000000 as i64);
}

fn test_std_time_duration_scalar_sugar_smoke() -> () {
  let d0: tm.Duration = (1 as i64 * tm.s).ns();
  t.assert_eq(d0.ns(), 1000000000 as i64);

  let d1: tm.Duration = (3 as i64).ms();
  t.assert_eq(d1.us(), 3000 as i64);
}
