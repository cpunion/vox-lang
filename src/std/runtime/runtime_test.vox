import "std/runtime" as rt
import "std/sync" as s
import "std/testing" as t

fn test_runtime_intrinsic_abi_and_intrinsic_probe_smoke() -> () {
  t.assert(rt.intrinsic_abi() >= 1);
  t.assert(!rt.has_intrinsic("__read_file"));
  t.assert(!rt.has_intrinsic("__wake_wait_any"));
  t.assert(!rt.has_intrinsic("not_real_intrinsic"));
}

fn test_runtime_wake_wait_any_smoke() -> () {
  let mut toks: Vec[i64] = Vec();
  toks.push(101 as i64);
  toks.push(102 as i64);
  t.assert_eq(rt.wake_wait_any(toks, 0), -1);
  rt.wake_notify(102 as i64);
  t.assert_eq(rt.wake_wait_any(toks, 1), 1);
}

fn test_runtime_atomic_via_sync_smoke() -> () {
  let a: s.Atomic[i32] = s.atomic[i32](1);
  t.assert_eq(s.atomic_load[i32](a), 1);
  let a2: s.Atomic[i32] = s.atomic_store[i32](a, 3);
  t.assert_eq(s.atomic_load[i32](a2), 3);
  s.atomic_drop[i32](a);
}
