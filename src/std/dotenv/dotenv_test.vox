import "std/dotenv" as dotenv
import "std/fs" as fs
import "std/testing" as t

fn test_dotenv_value_smoke() -> () {
  let path: String = "target/std_dotenv_test/.env";
  fs.mkdir_p("target/std_dotenv_test");
  fs.write_string(path, "A=1\nOPENAI_API_KEY=\"sk-test-001\"\n");
  t.assert_eq(dotenv.value(path, "OPENAI_API_KEY"), "sk-test-001");
}

fn test_dotenv_export_line_smoke() -> () {
  let path: String = "target/std_dotenv_test/export.env";
  fs.write_string(path, "export OPENAI_API_KEY='sk-test-002'\n");
  t.assert_eq(dotenv.value(path, "OPENAI_API_KEY"), "sk-test-002");
}

fn test_dotenv_value_from_paths_smoke() -> () {
  let mut paths: Vec[String] = Vec();
  paths.push("target/std_dotenv_test/missing.env");
  paths.push("target/std_dotenv_test/export.env");
  t.assert_eq(dotenv.value_from_paths(paths, "OPENAI_API_KEY"), "sk-test-002");
}
