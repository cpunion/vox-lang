fn test_syntax_reflect_intrinsic_calls() -> () {
  // SYNTAX:S906 reflect intrinsic call forms
  let src: String = """
struct S { a: i32, b: i64 }
type B = @field_type(S, 1)
fn main() -> i32 {
  let sz: usize = @size_of(i32);
  let al: usize = @align_of(S);
  let tid: usize = @type(i32);
  let same: bool = @same_type(i32, i64);
  let n: String = @field_name(S, 0);
  let _b: B = 1 as B;
  if same { return sz as i32 + al as i32 + tid as i32 + n.len(); }
  return 0;
}
""";
  syntax_assert_parse_ok("S906", src);
}

fn test_syntax_reflect_predicate_intrinsic_calls() -> () {
  // SYNTAX:S907 reflect predicate intrinsic call forms
  let src: String = """
type R = @range(0..=7) i32
struct S { a: i32 }
fn main() -> bool {
  return
    @is_integer(i32)
      && @is_signed_int(i32)
      && @is_unsigned_int(u32)
      && @is_vec(Vec[i32])
      && @is_range(R)
      && @is_bool(bool)
      && @is_string(String)
      && @is_eq_comparable(S)
      && @is_ordered(String)
      && @is_unit(())
      && @is_numeric(i64)
      && @is_zero_sized(());
}
""";
  syntax_assert_parse_ok("S907", src);
}

fn test_syntax_malformed_reflect_intrinsic_fails() -> () {
  // SYNTAX:S908 malformed reflect intrinsic parse failure
  syntax_assert_parse_fail("S908-size-of", "fn main() -> usize { return @size_of(i32; }");
  syntax_assert_parse_fail("S908-same-type", "fn main() -> bool { return @same_type(i32 i64); }");
}
