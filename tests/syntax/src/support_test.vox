import "std/testing" as t
import "vox/parse" as p

fn parse_ok(e: p.ParseError) -> bool { return e == p.ParseError.None; }

pub fn syntax_assert_parse_ok(id: String, src: String) -> () {
  let r: p.ParseResult = p.parse_text(src);
  t.assert_with(parse_ok(r.err), id.concat(": ").concat(p.parse_error_to_string(r.err)));
}

pub fn syntax_assert_parse_fail(id: String, src: String) -> () {
  let r: p.ParseResult = p.parse_text(src);
  t.assert_with(!parse_ok(r.err), id.concat(": expected parse failure"));
}

fn test_syntax_support_helpers_smoke() -> () {
  syntax_assert_parse_ok("support-ok", "fn main() -> i32 { return 0; }");
  syntax_assert_parse_fail("support-fail", "fn main() -> i32 { if true { return 1; } else return 0; }");
}
