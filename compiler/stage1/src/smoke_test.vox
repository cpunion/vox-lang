import "std/testing" as t

struct CompoundS { x: i32 }
const CONST_I8_A: i8 = 120;
const CONST_I8_B: i8 = CONST_I8_A + CONST_I8_A;
const CONST_U64_MAX: u64 = 18446744073709551615;
const CONST_U64_WRAP: u64 = CONST_U64_MAX + 1;

fn test_std_testing_smoke() -> () {
  t.assert(true);
  t.assert_eq(1 + 1, 2);
  t.assert_eq(true, true);
  t.assert_eq("a", "a");
}

fn test_prelude_fallback_smoke() -> () {
  // Unqualified names fall back to std/prelude.
  assert(true);
}

fn test_bitwise_and_shift_smoke() -> () {
  let a: i32 = 6 & 3;
  let b: i32 = 1 << 4;
  let c: i32 = b >> 2;
  t.assert_eq((a | c) ^ 1, 7);
}

fn test_compound_assign_smoke() -> () {
  let mut x: i32 = 32;
  x += 10;
  x -= 2;
  x *= 3;
  x /= 5;
  x %= 7;
  x <<= 4;
  x >>= 3;
  x &= 3;
  x |= 8;
  x ^= 15;

  let mut s: CompoundS = CompoundS { x: 32 };
  s.x += 10;
  s.x -= 2;
  s.x *= 3;
  s.x /= 5;
  s.x %= 7;
  s.x <<= 4;
  s.x >>= 3;
  s.x &= 3;
  s.x |= 8;
  s.x ^= 15;
  t.assert_eq(x + s.x, 10);
}

fn test_const_i8_wrapping_add_smoke() -> () {
  let ok: bool = (CONST_I8_B as i32) == ((-16) as i32);
  t.assert(ok);
}

fn test_const_u64_wrapping_add_smoke() -> () {
  t.assert(CONST_U64_WRAP == 0);
}

fn test_expr_cast_u64_max_literal_smoke() -> () {
  let x: u64 = 18446744073709551615 as u64;
  t.assert(x > 1);
}
