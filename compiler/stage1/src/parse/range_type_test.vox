import "std/testing" as t
import "parse" as p
import "ast" as ast

fn test_parse_range_type_alias_decl() -> () {
  let src: String = "type Tiny = @range(0..=3) i32\nfn main() -> i32 { return 0; }";
  let r: p.ParseResult = p.parse_text(src);
  t.assert(r.err == p.ParseError.None);
  t.assert_eq(r.prog.types.len(), 1);
  let td: ast.TypeAliasDecl = r.prog.types.get(0);
  t.assert_eq(td.name, "Tiny");
  t.assert_eq(td.ty.parts.len(), 3);
  t.assert(td.ty.parts.get(0) == "@range");
  t.assert(td.ty.parts.get(1) == "0");
  t.assert(td.ty.parts.get(2) == "3");
  t.assert_eq(td.ty.args.len(), 1);
  t.assert(td.ty.args.get(0).parts.len() == 1 && td.ty.args.get(0).parts.get(0) == "i32");
}

